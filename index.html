<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">


    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

    <link rel="stylesheet" href="css/main.css">


    <title>Curaid</title>

  </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <div class="container-fluid">
      <div class="row align-items-center">
        <div class="col-md-6 ml-1 left-column" style="">
          <div class="row justify-content-center min-vh-100 ">
            <div class="col-12" style="max-width: 500px;">
              <div class="banner">
                <div class="overlay">
                </div>
                  <img width="150" src="img/logo.png" class="float-left logo d-none d-md-block">
                  <img src="img/logo-mobile.png" class="float-left logo-mobile d-md-none">
                  <h2 style="position: relative;">Get free one month supply</h2>
                
              </div>
              <p class="content-text">Why explain the benefits if you can <strong>try the Curaid</strong> yourself? <strong>Leave us your email</strong> and we'll send you free one month supply of our new <strong>science-based</strong> skincare products: <strong>1x</strong> Cleanser 50 ml + <strong>1x</strong> Cream 50 ml</p>

              <div id="accordion" class="accordion cmb-1">
                <div class="card">
                  <div class="card-header d-flex flex-wrap align-content-center">
                    <a class="btn w-100 d-block" data-bs-toggle="collapse" href="#collapseOne">
                      Specially designed for men with... <i style="float: right;" class="bi accordion-icon"></i>
                    </a>
                    
                  </div>
                  <div id="collapseOne" class="collapse" data-bs-parent="#accordion">
                    <div class="card-body pb-4">
                      <div class="row">
                        <div class="col-md-6" style="">
                          <ul class="list-group list-group-flush">
                            <li class="list-group-item"><i class="bi bi-check2"></i> <p>Oily/shiny skin</p></li>
                            <li class="list-group-item"><i class="bi bi-check2"></i> <p>Textured skin</p></li>
                            <li class="list-group-item"><i class="bi bi-check2"></i> <p>Pimples</p></li>
                            <li class="list-group-item"><i class="bi bi-check2"></i> <p>Black heads</p></li>
                          </ul>
                        </div>
                        <div class="col-md-6" style="">
                          <ul class="list-group list-group-flush">
                            <li class="list-group-item"><i class="bi bi-check2"></i> <p>Large Pores</p></li>
                            <li class="list-group-item"><i class="bi bi-check2"></i> <p>Red spots</p></li>
                            <li class="list-group-item"><i class="bi bi-check2"></i> <p>Flaky skin</p></li>
                            <li class="list-group-item"><i class="bi bi-check2"></i> <p>Demaged skin barrier</p></li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>   
              </div>
              
              <p class="sign-up-heading" style="">Sign up and get free&nbsp;1-month supply</p>

              <!-- Button trigger modal -->
              <button type="button" class="btn btn-primary btn-lg btn-block w-100 d-block cmb-1" data-bs-toggle="modal" data-bs-target="#modal">Unlock your supply</button>

              <!-- Modal -->
              <div class="modal fade" id="modal" tabindex="-1" aria-labelledby="ModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="modal-header">
                      <h3 class="modal-title" id="ModalLabel">Sign up to waitlist and get free 1-month supply</h3>
                    </div>
                    <div class="modal-body">
                      <p>Skin type:</p>
                      <form name="contact" id="contact-form">                        
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="oily" required>
                        <label class="form-check-label" for="inlineRadio1">Oily skin</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="dry" required>
                        <label class="form-check-label" for="inlineRadio2">Dry skin</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio3" value="combination" required>
                        <label class="form-check-label" for="inlineRadio3">Combination</label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio4" value="normal" required>
                        <label class="form-check-label" for="inlineRadio3">Normal</label>
                      </div>


                      <div class="mt-3">
                        <input type="email" class="form-control" id="email" name="Email" placeholder="Your email" required>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button  type="submit" class="btn btn-primary btn-block btn-sign" id="FormSubmit">Sign up</button>
                    </div>
                  </form>


                  </div>
                </div>
              </div>

              <div class="row services" style="">

                <div class="d-flex p-0 justify-content-between flex-column flex-sm-row">
                  <div class="service-item d-flex align-items-center justify-content-start w-55">
                    <div class="w-30 service-icon">
                      <img width="58" src="img/results.png" class="float-left">
                    </div>
                    <div class="w-70">
                      <p class="mb-0" style="font-size:20px;">Guaranteed results</p>
                    </div>
                  </div>
                  <div class="service-item d-flex align-items-center justify-content-end w-45">
                    <div class="w-30 service-icon">
                      <img width="58" src="img/shipping.png" class="float-left ml-1">
                    </div>
                    <div class="w-70">
                      <p class="mb-0" style="font-size:20px;">Free shipping</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row progress-card">
                <div class="col">
                  <div class="card counter">
                    <div class="card-body">
                      <div class="row">
                        <div class="col-8 col-md-6">
                          <p class="text-left">The first 500 people</p>
                        </div>
                        <div class="col-4 col-md-6">
                          <p class="text-right" style="text-align:right;" id="NumberOfPreOrders"><strong>0</strong> / 500</p>
                        </div>
                      </div>
                      <div class="progress">
                        <div class="progress-bar" role="progressbar" style="width: 1%" aria-valuenow="250" aria-valuemin="0" aria-valuemax="500" id="NumberOfPreOrdersBar"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
          

        </div>
        <div class="col-md-6 right-column d-none d-md-block position-fixed top-0 end-0">
          <img class="svg-logo" src="img/svg-logo.svg">
       </div>
      </div>
    </div> <!-- /container -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      (function() {
        $("#accordion").on("show.bs.collapse hide.bs.collapse", function(e) {
          if (e.type=='show'){
            $(this).addClass('active');
          }else{
            $(this).removeClass('active');
          }
        });  

      }).call(this);
    </script>
    <script src="https://unpkg.com/@supabase/supabase-js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      NumberOfPreOrdersBar = document.getElementById("NumberOfPreOrdersBar");
      FormSubmitButton = document.getElementById("FormSubmit");
      NumberOfPreOrdersNumber = document.getElementById("NumberOfPreOrders");
      const form = document.querySelector('#contact-form');
      const formInputs = form.querySelectorAll('input');
      let submision = {}
      const { createClient } = supabase;
      let numberOfCustomers = 0;
      UserExists = false;
      supabase = createClient("https://auoxoswqglhbrrfkivtz.supabase.co", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF1b3hvc3dxZ2xoYnJyZmtpdnR6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2NTIxNzgyNDcsImV4cCI6MTk2Nzc1NDI0N30.8BcYSvppHR30ZuYRg4JP8CSINk8bURCfXCoIYyoV5UM");
      const { data, error } =  supabase.from('CuriadPreOrderForm').select('id').then(response => {
        if(response.error != null){
            numberOfCustomers = 500;
            NumberOfPreOrdersNumber.innerHTML = "<strong>" + numberOfCustomers + "</strong>" + " / 500";
            FormSubmitButton.innerHTML = "Maximum of preorders have been reached, Sorry !"
            NumberOfPreOrdersBar.setAttribute("style","width: " + (numberOfCustomers/5) + "%");
            FormSubmitButton.setAttribute("disabled", "");
        } else {
          numberOfCustomers = response.data.length;
          if(numberOfCustomers >= 500){
            NumberOfPreOrdersNumber.innerHTML = "<strong>" + 500 + "</strong>" + " / 500";
            FormSubmitButton.innerHTML = "Maximum of preorders have been reached, Sorry !"
            NumberOfPreOrdersBar.setAttribute("style","width: " + (500/5) + "%");
            FormSubmitButton.setAttribute("disabled", "");
          }else{
            NumberOfPreOrdersNumber.innerHTML = "<strong>" + numberOfCustomers + "</strong>" + " / 500";
            NumberOfPreOrdersBar.setAttribute("style","width: " + (numberOfCustomers/5) + "%");
          }
        }
      });

      form.addEventListener('submit', async (event) => {
          event.preventDefault()
          formInputs.forEach(element => {
            const { value, name } = element
            if (element.checked) {
                submision[name] = value;
            }
            if(element.id == 'email' && element.value != ''){
              submision[name] = value;
            }
          })

          const CheckIfUserExists =  await supabase.from('CuriadPreOrderForm').select('id').eq("Email", submision.Email).then(response => {
            UserExists = false;
            if(response.data.length > 0){
              Swal.fire({
              position: 'center',
              icon: 'error',
              title: 'This email address has been already used. Promotion is limited to one per person.',
              showConfirmButton: true
              });         
              UserExists = true;
            }
          });

          if(UserExists == false){
            const { error , data} = await supabase.from('CuriadPreOrderForm').insert([submision], { returning: 'minimal'})
            if (error) {
                alert('There was an error please try again')
            } else {
              Swal.fire({
              position: 'center',
              icon: 'success',
              title: 'Waitlist sing up successful',
              showConfirmButton: false,
              timer: 2500
              });
              setTimeout(() => { location.reload(); }, 2500);
            }

            formInputs.forEach(element => element.value = '');
          }


      });
  </script>

    </body>
</html>


